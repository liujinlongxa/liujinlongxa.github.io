<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>liujinlongxa的技术博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="生命永不息，Coding永不止">
<meta property="og:type" content="website">
<meta property="og:title" content="liujinlongxa的技术博客">
<meta property="og:url" content="http://liujinlongxa.com/index.html">
<meta property="og:site_name" content="liujinlongxa的技术博客">
<meta property="og:description" content="生命永不息，Coding永不止">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="liujinlongxa的技术博客">
<meta name="twitter:description" content="生命永不息，Coding永不止">
  
    <link rel="alternate" href="/atom.xml" title="liujinlongxa的技术博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">liujinlongxa的技术博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://liujinlongxa.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-使用nat123实现外网ssh连接内网树莓派设备" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/11/05/使用nat123实现外网ssh连接内网树莓派设备/" class="article-date">
  <time datetime="2016-11-05T09:56:46.000Z" itemprop="datePublished">2016-11-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/树莓派/">树莓派</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/05/使用nat123实现外网ssh连接内网树莓派设备/">使用nat123实现外网ssh连接内网树莓派设备</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://zh.wikipedia.org/zh-cn/%E6%A0%91%E8%8E%93%E6%B4%BE" target="_blank" rel="external">树莓派</a>是一款基于Linux的单板机电脑。最近入手了一块，打算作为Linux服务器来使用。</p>
<p>树莓派自带以太网接口和Wifi模块，可以通过网线或Wifi连接网络。但是由于我家里的网络是电信的光纤网络，用的是电信配的路由器，各个终端都是通过Wifi或网线连到这个路由上，因此各个终端相当于处于局域网，外网无法通过ip直接访问到内网的树莓派设备，这样如果我在树莓派上搭建一个服务器，外网就无法访问。</p>
<p>一般这种问题，只需要在路由器上设置一下<a href="http://www.hrtl.com.cn/News_398.aspx" target="_blank" rel="external">端口映射</a>就可通过外网访问内网主机了，但是电信配的这个路由器不支持设置端口映射（吐槽一下，电信自带的路由器简直弱爆了），所有就没办法通过设置路由器的方法解决。</p>
<p>经过一番探索，找了一种可行的方案：<a href="http://www.nat123.com/" target="_blank" rel="external">nat123</a>。nat123是一家专业提供端口映射和域名解析的网站，下面我就详细介绍一下如何使用nat123来实现外网访问内网树莓派设备。</p>
<h2 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h2><h3 id="第一步-准备工作"><a href="#第一步-准备工作" class="headerlink" title="第一步 准备工作"></a>第一步 准备工作</h3><p>确保在内网环境下可以通过ssh访问树莓派，如何在树莓派上配置ssh，可以参考<a href="http://www.itnose.net/detail/6109563.html" target="_blank" rel="external">这篇文章</a></p>
<h3 id="第二步-注册nat123"><a href="#第二步-注册nat123" class="headerlink" title="第二步 注册nat123"></a>第二步 注册nat123</h3><p>打开<a href="http://www.nat123.com/" target="_blank" rel="external">nat123</a>官网，点击右上角的注册按钮完成注册</p>
<h3 id="第三步-在树莓派上安装nat123-Linux版"><a href="#第三步-在树莓派上安装nat123-Linux版" class="headerlink" title="第三步 在树莓派上安装nat123 Linux版"></a>第三步 在树莓派上安装nat123 Linux版</h3><p>打开树莓派，按照<a href="http://www.nat123.com/pages_17_600.jsp" target="_blank" rel="external">这篇文章</a>的内容安装并启动相关软件。这里注意要根据你树莓派上的操作系统选择不同的安装方式，如果安装的官方操作系统Raspbian，应该选用Debian系统的安装方式。</p>
<h3 id="第四步-配置端口映射"><a href="#第四步-配置端口映射" class="headerlink" title="第四步 配置端口映射"></a>第四步 配置端口映射</h3><p>登录<a href="http://www.nat123.com/" target="_blank" rel="external">nat123</a>，在左侧的用户中心点击“端口映射添加”，如下图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/7855931f84f019009241b787d7c35f87.png" alt="1"></p>
<p>应用类型选择“其他（非网站）”，这里我要实现的是通过ssh访问树莓派，所有不是80端口，具体应该根据自己的需求选择应用类型，可以参考<a href="http://www.nat123.com/Pages_8_570.jsp" target="_blank" rel="external">这篇文章</a>。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/d784b452f4e1a71ef9555fd783b95386.png" alt="2"></p>
<p>下面解释一下每一项的含义：</p>
<ul>
<li>应用名称：随便起，这里因为是用于ssh连接的，所以起名为ssh</li>
<li>内网端口：内网应用的端口，ssh访问默认端口为22，如果是其他服务，这里的端口号应该填相应服务的端口号，例如，ftp服务默认端口号为21，http服务默认端口80等。</li>
<li>内网地址：即树莓派在内网的ip地址，可以通过<code>ifconfig</code>命令查看</li>
<li>外网端口：自动生成，要记住这个端口号，待会链接是要用到</li>
<li>外网域名：自动生成，这就是外网要访问的地址</li>
</ul>
<p>然后点击“确认保存”，这里需要认证，认证需要收费（30￥），付款完成后，再次点击“确认保存”，就可以保存成功。可以在左侧的“端口映射列表”里查看和修改添加的端口映射。</p>
<p>这样就完成了端口映射的添加。</p>
<h3 id="第五步-外网访问"><a href="#第五步-外网访问" class="headerlink" title="第五步 外网访问"></a>第五步 外网访问</h3><p>这时就已经可以通过外网访问了，在外网环境下打开终端，输入命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh pi@45067491.nat123.net -p 22996</div></pre></td></tr></table></figure>
<p>然后输入密码，就可以通过ssh访问树莓派了。这里”pi”是你在树莓派里的用户名，-p参数是刚才的端口号。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>以上就是我使用nat123实现外网访问内网树莓派设备的这个过程。整个过程并不复杂，但是我在进行的过程中还是磕磕绊绊折腾了好久才完全整好，不过这个过程中还是学到了不少的东西。</p>
<p>由于水平有限，如果上文中有不正确的地方，欢迎大家交流指正。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/11/05/使用nat123实现外网ssh连接内网树莓派设备/" data-id="civ7gro74003oh4m0tfnhvls7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSH/">SSH</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/树莓派/">树莓派</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网络/">网络</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Swift3中的预处理宏" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/28/Swift3中的预处理宏/" class="article-date">
  <time datetime="2016-10-28T09:18:57.000Z" itemprop="datePublished">2016-10-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Swift/">Swift</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/28/Swift3中的预处理宏/">Swift3中的预处理宏</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Swift中也可以使用预处理宏，只不过和ObjectiveC有点不一样，下面详细说明一下。</p>
<ul>
<li>Swift中取消了#define，建议使用全局常量替换宏定义</li>
<li>Swift中仍然可以使用<code>#if, #elseif, #endif</code>等宏，注意，Swift中是<code>#elseif</code>，而在OC中是<code>#elif</code>。还有<code>#if</code>和<code>#elseif</code>后面的判断条件必须是Bool类型的。</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#<span class="keyword">if</span> <span class="literal">false</span></div><div class="line"><span class="built_in">print</span>(<span class="string">"aaaa"</span>)</div><div class="line">#elseif <span class="literal">true</span></div><div class="line"><span class="built_in">print</span>(<span class="string">"bbbb"</span>)</div><div class="line">#<span class="keyword">else</span></div><div class="line"><span class="built_in">print</span>(<span class="string">"cccc"</span>)</div><div class="line">#endif</div></pre></td></tr></table></figure>
<ul>
<li>Swift中取消了<code>__FUNCTION__, __FILE__, __LINE__</code>，分别改为了<code>#function, #file, #line</code></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">print</span>(#file)</div><div class="line"><span class="built_in">print</span>(#line)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">function1</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="built_in">print</span>(#function)</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/10/28/Swift3中的预处理宏/" data-id="civ7gro6z003lh4m0njqkthw8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/预处理宏/">预处理宏</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-给多个Target添加CocoaPods" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/26/给多个Target添加CocoaPods/" class="article-date">
  <time datetime="2016-10-26T14:25:04.000Z" itemprop="datePublished">2016-10-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS开发/">iOS开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/26/给多个Target添加CocoaPods/">给多个Target添加CocoaPods</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><p>一般我们使用CocoaPods进行依赖管理时，如果项目里只有一个Target，则Podfile文件的格式应该是：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'ZipApp'</span> <span class="keyword">do</span>  <span class="comment"># ZipApp为Target名称</span></div><div class="line">  pod <span class="string">'SSZipArchive'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>如果项目中有多个Target，可以定义多个这样的block，如下：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'ZipApp'</span> <span class="keyword">do</span>  <span class="comment"># ZipApp为Target名称</span></div><div class="line">  pod <span class="string">'SSZipArchive'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">target <span class="string">'ZipAppTest'</span> <span class="keyword">do</span>  <span class="comment"># ZipAppTest为另一个Target名称</span></div><div class="line">  pod <span class="string">'SSZipArchive'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>如果多个Target的依赖的库都是一样的，没有必要每一个Target都把所有库都写一遍，可以定义一个函数，写法如下：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">common_pods</span></span></div><div class="line">    pod <span class="string">'SSZipArchive'</span></div><div class="line">    pod <span class="string">'AFNetworking'</span></div><div class="line">    pod <span class="string">'JSPatch'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">target <span class="string">'ZipApp'</span> <span class="keyword">do</span>  <span class="comment"># ZipApp即使Target名称</span></div><div class="line">  common_pods</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">target <span class="string">'ZipAppTest'</span> <span class="keyword">do</span></div><div class="line">    common_pods</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="其他的用法"><a href="#其他的用法" class="headerlink" title="其他的用法"></a>其他的用法</h3><p>如果多个Target有嵌套关系，即一个Target是另一个Target的父Target，则可以写成以下形式：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'ZipApp'</span> <span class="keyword">do</span></div><div class="line">  pod <span class="string">'SSZipArchive'</span></div><div class="line"></div><div class="line">  target <span class="string">'ZipAppTests'</span> <span class="keyword">do</span></div><div class="line">    inherit! <span class="symbol">:search_paths</span> <span class="comment"># 这句话表示子Target继承了父Target包含的pod，即ZipAppTests这个Target里包含了SSZipArchive和Nimble两个pod</span></div><div class="line">    pod <span class="string">'Nimble'</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>如果一个Workspace里包含了多个Project，并且每一个Project都有不同的Target，则可以使用以下形式定义多个Project的Target：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'Target1'</span> <span class="keyword">do</span></div><div class="line">  project <span class="string">'Project1'</span></div><div class="line">  pod <span class="string">'AFNetworking'</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">target <span class="string">'Target2'</span> <span class="keyword">do</span></div><div class="line">  project <span class="string">'Project2'</span></div><div class="line">  pod <span class="string">'JSPatch'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/10/26/给多个Target添加CocoaPods/" data-id="civ7gro6v003fh4m0kvs2k1xh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CocoaPods/">CocoaPods</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Target/">Target</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-如何获取WebView的UserAgent" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/25/如何获取WebView的UserAgent/" class="article-date">
  <time datetime="2016-10-25T03:46:04.000Z" itemprop="datePublished">2016-10-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/25/如何获取WebView的UserAgent/">如何获取WebView的UserAgent</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>项目中用到了WebView的UserAgent，可以通过以下方式获取到：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIWebView</span>* webView = [[<span class="built_in">UIWebView</span> alloc] init];</div><div class="line"><span class="built_in">NSString</span>* secretAgent = [webView stringByEvaluatingJavaScriptFromString:<span class="string">@"navigator.userAgent"</span>];</div></pre></td></tr></table></figure>
<p>如果是WKWebView，可以通过以下方式获取</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">WKWebView</span> *webView = [[<span class="built_in">WKWebView</span> alloc] init];</div><div class="line">[webView evaluateJavaScript:<span class="string">@"navigator.userAgent"</span> completionHandler:^(<span class="keyword">id</span> _Nullable userAgent, <span class="built_in">NSError</span> * _Nullable error) &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"userAgent: %@"</span>, userAgent);</div><div class="line">&#125;];</div><div class="line"><span class="keyword">self</span>.webView = webView; <span class="comment">// 注意，一定要对webView进行强引用</span></div></pre></td></tr></table></figure>
<p>获取到的值的为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Mozilla/5.0 (iPhone; CPU iPhone OS 10_0_1 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) Mobile/14A403</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/10/25/如何获取WebView的UserAgent/" data-id="civ7gro6x003ih4m0dzidsgdj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/其他/">其他</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-iOS10无法获取IDFA的问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/18/iOS10无法获取IDFA的问题/" class="article-date">
  <time datetime="2016-10-18T02:17:44.000Z" itemprop="datePublished">2016-10-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/18/iOS10无法获取IDFA的问题/">iOS10无法获取IDFA的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>iOS10上，如果用户开启了“限制广告跟踪”选项（设置-&gt;隐私-&gt;广告），则在使用<code>[[[ASIdentifierManager sharedManager] advertisingIdentifier] UUIDString]</code>方法获取IDFA时会返回全部是0，如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/13bbfe746dacb7c156cac2aaac5b2c0d.png" alt="1"></p>
<p>有两种解决方案：</p>
<p>第一种方法是通过<code>isAdvertisingTrackingEnabled</code>属性判断是否可以返回正确的IDFA，如果返回为NO，则可以提示用户去设置中关闭限制广告跟踪。代码如下：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *idfa = <span class="literal">nil</span>;</div><div class="line"><span class="keyword">if</span> ([[ASIdentifierManager sharedManager] isAdvertisingTrackingEnabled]) &#123;</div><div class="line">    idfa = [[[ASIdentifierManager sharedManager] advertisingIdentifier] UUIDString];</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// 弹窗提示用户关闭限制广告跟踪</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>另外一种更好的方法是使用第三方库获取IDFA，这里推荐两个第三方库：<a href="https://github.com/ylechelle/OpenIDFA" target="_blank" rel="external">OpenIDFA</a>和<a href="https://github.com/youmi/SimulateIDFA" target="_blank" rel="external">SimulateIDFA</a>，个人更推荐SimulateIDFA，因为他的重复率更低。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/10/18/iOS10无法获取IDFA的问题/" data-id="civ7gro6t003bh4m0f8v2lye8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IDFA/">IDFA</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-获取本地化的APP版本描述信息" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/09/获取本地化的APP版本描述信息/" class="article-date">
  <time datetime="2016-10-09T15:25:15.000Z" itemprop="datePublished">2016-10-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/09/获取本地化的APP版本描述信息/">获取本地化的APP版本描述信息</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在制作APP升级提示框时，需要APP的最新版本信息，苹果提供了”<a href="http://itunes.apple.com/lookup?id=123123&quot;接口用于查询AppStore上的APP的详细信息，参数id表示的是应用程序的AppId。" target="_blank" rel="external">http://itunes.apple.com/lookup?id=123123&quot;接口用于查询AppStore上的APP的详细信息，参数id表示的是应用程序的AppId。</a></p>
<p>如果在iTunesConnect上对应用的版本描述信息做了本地化，上述接口只会返回首选语言的描述信息，如果要返回特定语言的描述信息，还要加上两个参数:</p>
<ul>
<li>country: 国家参数，CN表示中国，US表示美国，国家代码可以在<a href="https://zh.wikipedia.org/wiki/ISO_3166-1" target="_blank" rel="external">这里</a>找到</li>
<li>lang: 语言参数，zh_cn表示中文，zh_tw表示繁体中文，en_us表示美国英国，语言编码可以参考<a href="https://zh.wikipedia.org/wiki/%E5%8C%BA%E5%9F%9F%E8%AE%BE%E7%BD%AE" target="_blank" rel="external">维基百科</a></li>
</ul>
<p>例如：</p>
<ul>
<li>要获取中文的描述信息，应该调用<a href="http://itunes.apple.com/lookup?id=123123&amp;country=CN&amp;lang=zh_cn" target="_blank" rel="external">http://itunes.apple.com/lookup?id=123123&amp;country=CN&amp;lang=zh_cn</a></li>
<li>要获取繁体中文的描述信息，应该调用<a href="http://itunes.apple.com/lookup?id=123123&amp;country=TW&amp;lang=zh_tw" target="_blank" rel="external">http://itunes.apple.com/lookup?id=123123&amp;country=TW&amp;lang=zh_tw</a></li>
<li>要获取英文的描述信息，应该调用<a href="http://itunes.apple.com/lookup?id=123123&amp;country=US&amp;lang=en_us" target="_blank" rel="external">http://itunes.apple.com/lookup?id=123123&amp;country=US&amp;lang=en_us</a></li>
</ul>
<p>参考资料：</p>
<p><a href="https://zh.wikipedia.org/wiki/%E5%8C%BA%E5%9F%9F%E8%AE%BE%E7%BD%AE" target="_blank" rel="external">语言区域</a><br><a href="https://zh.wikipedia.org/wiki/ISO_3166-1" target="_blank" rel="external">ISO_3166-1</a><br><a href="https://affiliate.itunes.apple.com/resources/documentation/itunes-store-web-service-search-api/" target="_blank" rel="external">iTunes Affiliate Resources</a><br><a href="http://blog.hoachuck.biz/blog/2012/07/01/playing-around-with-app-store-meta-data/" target="_blank" rel="external">Playing Around With App Store Meta Data</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/10/09/获取本地化的APP版本描述信息/" data-id="civ7gro6q0035h4m0ly1cwctj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/本地化/">本地化</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-iOS多环境配置实践" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/07/iOS多环境配置实践/" class="article-date">
  <time datetime="2016-10-07T02:04:43.000Z" itemprop="datePublished">2016-10-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS开发/">iOS开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/07/iOS多环境配置实践/">iOS多环境配置实践</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在移动客户端开发过程中，服务器一般都会提供多个环境的API接口，例如测试环境(TEST_ENV)，发布环境(RELEASE_ENV)，预发布环境(PRERELEASE_ENV)等，我们客户端在打包的时候需要在不同的阶段打不同环境的包，最简单的做法就是在代码里直接修改URL来切换不同的环境。但是这种做法太Low了，而且也不易于使用脚本自动打包。本文的主要内容就是介绍一种不修改代码达到配置不同环境的方法。</p>
<h2 id="明确需求"><a href="#明确需求" class="headerlink" title="明确需求"></a>明确需求</h2><p>在开始主要内容之前，先明确一下需求：</p>
<ol>
<li>服务器有三个环境，测试环境(TEST_ENV)，发布环境(RELEASE_ENV)，预发布环境(PRERELEASE_ENV)，要求要很方便的实现在三个不同环境之间自由切换</li>
<li>代码中大量使用了DEBUG宏，因此要求每个环境都应该区分DEBUG和RELEASE，即在任一环境下都可能需要打DEBUG包或RELEASE包</li>
</ol>
<p>为此，我编写了一份测试代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">#if TEST_ENV // 测试环境</div><div class="line">#if DEBUG</div><div class="line">    NSLog(@&quot;hello test env debug&quot;);</div><div class="line">#else</div><div class="line">    NSLog(@&quot;hello test env release&quot;);</div><div class="line">#endif</div><div class="line">#endif</div><div class="line"></div><div class="line">#if RELEASE_ENV // 发布环境</div><div class="line">#if DEBUG</div><div class="line">    NSLog(@&quot;hello release env debug&quot;);</div><div class="line">#else</div><div class="line">    NSLog(@&quot;hello release env release&quot;);</div><div class="line">#endif</div><div class="line">#endif</div><div class="line"></div><div class="line">#if PRERELEASE_ENV // 预发布环境</div><div class="line">#if DEBUG</div><div class="line">    NSLog(@&quot;hello pre-relase env debug&quot;);</div><div class="line">#else</div><div class="line">    NSLog(@&quot;hello pre-relase env release&quot;);</div><div class="line">#endif</div><div class="line">#endif</div></pre></td></tr></table></figure>
<h2 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h2><h3 id="1-为每一个环境创建一个Target"><a href="#1-为每一个环境创建一个Target" class="headerlink" title="1. 为每一个环境创建一个Target"></a>1. 为每一个环境创建一个Target</h3><p>创建项目后，项目本身就会有一个Target（如果不了解Target的概念可以看一下<a href="https://developer.apple.com/library/content/featuredarticles/XcodeConcepts/Concept-Targets.html" target="_blank" rel="external">这篇官方文档</a>）,我们可以把这个Target就作为某一个环境的Target，这里我们把它作为发布环境的Target，然后还需要创建测试环境和预发布环境的Target，方法如下：</p>
<p>在项目配置界面左侧，选中Target，点击右键，选择”Duplicate”，复制一个新的Target，如下图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/ec6ceac9d953c320c0cbf0bfe55ee361.png" alt="1"></p>
<p>然后在弹出的菜单中点击”Duplicate Only”</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/463b4e2b32269ab485d9f160315e1d75.png" alt="2"></p>
<p>这样就创建好了一个新的Target。新的Target的默认名称为”项目名称 copy”，即”Test1007 copy”，单击新创建的Target，修改Target名称为”Test1007_Test”，将这个Target作为测试环境的Target。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/4e99d383134b80176fedbe7853327b6f.png" alt="3"></p>
<p>创建完Target后，XCode会自动为这个Target创建一个Scheme，为了方便起见，也将这个Scheme的名称修改为”Test1007_Test”，方法是在左上角点击”Manage Schemes…”，单机要修改名称的Scheme，即可修改Scheme的名称。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/32c4abd9100ed10efbebda4f876c5939.png" alt="4"></p>
<p>同样的方法，在创建一个名为”Test1007_Prerelease”的Target作为预发布环境的Target。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/640b7eebdbb792330544b5211110f278.png" alt="5"></p>
<h3 id="2-配置环境变量"><a href="#2-配置环境变量" class="headerlink" title="2. 配置环境变量"></a>2. 配置环境变量</h3><p>配置环境变量，就是添加TEST_ENV，RELEASE_ENV和PRERELEASE_ENV这三个宏，这一步在ObjectiveC下和Swift是不一样的，这里会分别讲解</p>
<h4 id="ObjectiveC下配置环境变量"><a href="#ObjectiveC下配置环境变量" class="headerlink" title="ObjectiveC下配置环境变量"></a>ObjectiveC下配置环境变量</h4><p>在项目配置界面选择发布环境的Target “Test1007”，点击Build Settings，找到Preprocessor Macros，在Debug和Release下都添加环境变量”RELEASE_ENV=1”，如图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/e685c55dc756723ecd8a2d513efca11e.png" alt="6"></p>
<p>添加完成后结果如图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/60989466ad3f7b1b1e272210c2fafe8d.png" alt="7"></p>
<p>这样就为发布环境添加好了”RELEASE_ENV”宏。</p>
<p>同样的方法，分别在Target “Test1007_Test”和”Test1007_Prerelease”添加TEST_ENV和PRERELEASE_ENV这两个宏。</p>
<h4 id="Swift下配置环境变量"><a href="#Swift下配置环境变量" class="headerlink" title="Swift下配置环境变量"></a>Swift下配置环境变量</h4><p>在项目配置界面选择发布环境的Target “Test1007”，点击Build Settings，找到Other Swift Flags，在Debug和Release下都添加环境变量”-D RELEASE_ENV”，如图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/d7ec2f7e6073166d15fc64d488b42fcb.png" alt="8"></p>
<p>添加完成后如图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/2697bee36a116092b03257cfca9bf774.png" alt="9"></p>
<p>同样的方法，分别在Target “Test1007_Test”和”Test1007_Prerelease”下添加TEST_ENV和PRERELEASE_ENV这两个宏。</p>
<p>这样就完成了环境变量的配置。</p>
<h3 id="3-为不同环境的包配置不同的名称，BundleId和图标"><a href="#3-为不同环境的包配置不同的名称，BundleId和图标" class="headerlink" title="3. 为不同环境的包配置不同的名称，BundleId和图标"></a>3. 为不同环境的包配置不同的名称，BundleId和图标</h3><p>其实到这一步就已经完成了不同环境的配置，要切换环境，只需要切换左上角的Scheme就可以了。为了更好的区分不同环境下的包，可以给每个环境配置不同的App名称，BundleId和App图标，方法如下：</p>
<p>在项目配置界面选中一个Target，通过修改Display Name和Bundle Identifier可以为不同环境的包设置不同的App名称和BundleId。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/98681390ae672ce58b2a541c3068e4c6.png" alt="10"></p>
<p>要设置不同的图标，需要在Build Settings里找到”Asset Calalog App Icon Set Name”，其默认值是AppIcon，可以为不同Target设置不同的Icon Set Name，然后在Assets.xcassets中添加对应的Image Set即可。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/a9fa6a0db2bccb6d5945fe5c3f4d8360.png" alt="11"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文是通过多个Target来实现多环境配置的，其实除了本文介绍的方法，还有其他方法可以实现多环境配置，具体可以参考<a href="http://www.jianshu.com/p/83b6e781eb51" target="_blank" rel="external">这篇文章</a>。</p>
<p>有了多环境配置，就可以很方便的实现多环境自动打包，如果在加入持续集成系统（例如jenkins等），就可以非常优雅的打包。这个以后有时间会专门写一篇博客来介绍相关内容。</p>
<p>参考资料：<br><a href="http://www.jianshu.com/p/83b6e781eb51" target="_blank" rel="external">手把手教你给一个iOS app配置多个环境变量</a><br><a href="http://www.cocoachina.com/ios/20151023/13869.html" target="_blank" rel="external">iOS开发必备–环境变量配置(Debug &amp; Release)</a><br><a href="http://kevindelord.io/2016/06/08/project-configuration/" target="_blank" rel="external">Xcode Project Configuration</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/10/07/iOS多环境配置实践/" data-id="civ7gro6o0031h4m0k65u9h9x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Scheme/">Scheme</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Target/">Target</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用xUnique遇到了的问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/04/使用xUnique遇到了的问题/" class="article-date">
  <time datetime="2016-10-04T14:24:27.000Z" itemprop="datePublished">2016-10-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/04/使用xUnique遇到了的问题/">使用xUnique遇到了的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>xUnique是一个用来对iOS向的<em>.xcodeproj文件进行排序的工具，它可以降低</em>.xcodeproj文件冲突的概率。其实质是一个Git Hook脚本，在提交一个Commit时，如果*.xcodeproj文件有修改，则会对文件进行重新排序。</p>
<p>最近在使用时发现了一个问题，当我执行“pod install”安装第三方库时，在进行提交时会报”File ‘project.pbxproj’ is broken. Cannot find PBXProject name.”，从字面意思看’project.pbxproj’文件损坏，但是进入*.xcodeproj文件夹，双击‘project.pbxproj’，发现是可以打开的，并没有问题。</p>
<p>最后通过查找资料，找到了原因，具体原因是由于在执行‘pod install’后，CocoaPods会重写‘project.pbxproj’文件，并且改变了它的格式，导致xUnique无法正确读取’project.pbxproj’文件。</p>
<p>解决方法是：让xcode重新生成‘project.pbxproj’，具体步骤如下：</p>
<ol>
<li>先关闭xUnique，然后提交代码。关闭xUnique的方法是打开“&lt;项目仓库根目录&gt;/.git/hooks/pre-commit”文件，注释掉xUnique有关的内容</li>
<li>做出任意一个可以导致’project.pbxproj’修改的修改，例如修改版本号，创建文件等，这样xcode会重写’project.pbxproj’文件</li>
<li>打开xUnique，提交代码，这时xUnique就可以识别’project.pbxproj’文件了</li>
</ol>
<p>参看文档：<br><a href="https://github.com/truebit/xUnique/issues/34" target="_blank" rel="external">File ‘project.pbxproj’ is broken. Cannot find PBXProject name.</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/10/04/使用xUnique遇到了的问题/" data-id="civ7gro6r0038h4m02cskk4dx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/其他/">其他</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用代码删除约束要注意的地方" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/12/使用代码删除约束要注意的地方/" class="article-date">
  <time datetime="2016-09-12T15:17:44.000Z" itemprop="datePublished">2016-09-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/12/使用代码删除约束要注意的地方/">使用代码删除约束要注意的地方</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>使用代码删除特定约束的正确姿势：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (IOS8_OR_LATER) &#123;</div><div class="line">    <span class="comment">// iOS8之后删除约束的方法</span></div><div class="line">    <span class="keyword">self</span>.authorLabelRightConstraint.active = <span class="literal">NO</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// iOS8之前删除约束的方法</span></div><div class="line">    [<span class="keyword">self</span> removeConstraint:<span class="keyword">self</span>.authorLabelRightConstraint];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意删除约束的方法在iOS8之前和之后是不一样的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/09/12/使用代码删除约束要注意的地方/" data-id="civ7gro6k002yh4m0ti7rl0xq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Autolayout/">Autolayout</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-做模糊效果时遇到的问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/30/做模糊效果时遇到的问题/" class="article-date">
  <time datetime="2016-08-30T14:51:53.000Z" itemprop="datePublished">2016-08-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/30/做模糊效果时遇到的问题/">做模糊效果时遇到的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近在做图片模糊效果时遇到了一个很奇怪的问题，在iPhone6/iPhone6s上显示的模糊效果如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/4661eedc0a33e9c4535d95a005bde5d2.png" alt="1"></p>
<p>但是在iPhone6 plus和iPhone6s plus上的模糊效果就如下图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/e31355553287234ae1b78b6ea88389ac.png" alt="2"></p>
<p>这明显效果不对，好像没有模糊一样。于是Google一些资料，终于找到了解决方法，解决方法是，在6Plus上不能设置过大的模糊半径，如果模糊半径过大，就会出现上图的效果。这和我使用的”UIImage+ImageEffects.h”也有关。</p>
<p>原先设置的模糊半径为52，现在改成了在6Plus和6sPlus上是45，在6和6s上还是52，这样就没问题了。</p>
<p>参考资料：</p>
<p><a href="http://stackoverflow.com/questions/26002970/applyblurwithradius-working-on-iphone-6-not-6-uiimageimageeffects" target="_blank" rel="external">applyBlurWithRadius working on iPhone 6, not 6+ (UIImage+ImageEffects)</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/08/30/做模糊效果时遇到的问题/" data-id="civ7gro6i002uh4m0ehfvedl1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/其他/">其他</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用Safair调试JS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/30/使用Safair调试JS/" class="article-date">
  <time datetime="2016-08-30T13:46:33.000Z" itemprop="datePublished">2016-08-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/30/使用Safair调试JS/">使用Safair调试JS</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>iOS项目中经常会用到Native界面和H5界面互相调用的情况，方法就是使用JavaScriptCore框架直接在原生界面中调用JS代码。如果JS代码较长，调试起来就会比较麻烦，这里介绍一种方法，可以让你轻松调试JS。</p>
<p>首先，打开Safari，打开偏好设置（快捷键Cmd+,），在Advanced中选中”Show Develop menu in menu bar”，如下图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/500ac2228a67a84dd4c20e73f104a560.png" alt="1"></p>
<p>这样菜单栏就会出现一个Develop菜单，点击菜单Develop-&gt;Simulator-&gt;Automatically Show Web Inspector For JSContexts</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/211795a2560cf0bc3973a5d778d96343.png" alt="2"></p>
<p>然后使用模拟器运行项目，当运行到JS代码时，就会自动启动调试器，如图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/19c6bf7d6bce0e9b54f289ccc9025ecc.png" alt="3"></p>
<p>和XCode一样，你可以打断点，当JS运行到这一句时就会进入断点</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/f6b607a7a949df00b9f2e20f11e7b29a.png" alt="4"></p>
<p>当进入断点后，还可以打印出相应的局部变量</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/993f4e504f25bc37a79cc1f6ffd1a9ca.png" alt="5"></p>
<p>以上就是使用Safari调试JS的方法。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/08/30/使用Safair调试JS/" data-id="civ7gro6g002rh4m0hdaucx0b" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/其他/">其他</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Mac下生成RSA密钥对要注意的问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/25/Mac下生成RSA密钥对要注意的问题/" class="article-date">
  <time datetime="2016-08-25T15:50:06.000Z" itemprop="datePublished">2016-08-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/其他/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/25/Mac下生成RSA密钥对要注意的问题/">Mac下生成RSA密钥对要注意的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>生成RSA密钥一般使用的Openssl，方法如下：</p>
<p>在终端输入命令openssl然后敲回车，进入openssl命令输入模式，如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/d0eff7b11f3bb040e28e46de5393d9d2.png" alt="1"></p>
<p>然后输入一下三行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">genrsa -out rsa_private_key.pem 1024</div><div class="line">pkcs8 -topk8 -in rsa_private_key.pem -out pkcs8_rsa_private_key.pem -nocrypt</div><div class="line">rsa -in rsa_private_key.pem -pubout -out rsa_public_key.pem</div></pre></td></tr></table></figure>
<p>然后输入exit退出openssl命令输入模式，这样会在当前目录生成三个文件，如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/980dc450a7d1f4db0759d42ac882f54a.png" alt="2"></p>
<p>其中：</p>
<ul>
<li>rsa_private_key.pem为私钥</li>
<li>rsa_public_key.pem为公钥</li>
<li>pkcs8_rsa_private_key.pem为PKCS#8编码的私钥</li>
</ul>
<p>公钥没有问题，主要是私钥，私钥有两个，两个有什么区别，到底该用哪一个呢？</p>
<p>主要区别在于：</p>
<ul>
<li>rsa_private_key.pem为PKCS#1编码，只包含RSA的密钥信息，是以”—–BEGIN RSA PRIVATE KEY—–”开头，以”—–END RSA PRIVATE KEY—–”结尾，如下图：</li>
</ul>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/9927f538bea6e031960a0a908076ccdd.png" alt="3"></p>
<ul>
<li>pkcs8_rsa_private_key.pem为PKCS#8编码，除了包含RSA密钥信息外，还包含一些附加信息，例如version和算法等，是以”—–BEGIN PRIVATE KEY—–”开头，以”—–END PRIVATE KEY—–”结尾的，如下图：</li>
</ul>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/b98831c564629c062c9bfcb5f7868625.png" alt="4"></p>
<p>Mac默认生成的是PKCS#1编码的私钥，而有的系统生成私钥是PKCS#8编码，具体用哪个这要看你的加密代码里是否对附加信息进行了校验判断，如果进行了校验，则应该使用PKCS#8编码的私钥，否则应该使用PKCS#1编码的私钥。</p>
<p>我使用的是<a href="https://github.com/ideawu/Objective-C-RSA" target="_blank" rel="external">这个第三方库</a>进行加密解密的，里面对附加信息进行了校验，所以应该使用PKCS#8编码的密钥。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://github.com/ideawu/Objective-C-RSA" target="_blank" rel="external">Objective-C-RSA</a><br><a href="https://github.com/ideawu/Objective-C-RSA/issues/15" target="_blank" rel="external">Objective-C-RSA Issuse #15</a><br><a href="http://www.tuicool.com/articles/Rbu6zm" target="_blank" rel="external">openssl生成RSA格式，并转为pkcs8格式</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/08/25/Mac下生成RSA密钥对要注意的问题/" data-id="civ7gro6f002oh4m0yzzw511v" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/加密解密/">加密解密</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用ownCloud作为OmniFocus的云同步服务器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/24/使用ownCloud作为OmniFocus的云同步服务器/" class="article-date">
  <time datetime="2016-08-24T14:47:22.000Z" itemprop="datePublished">2016-08-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/其他/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/24/使用ownCloud作为OmniFocus的云同步服务器/">使用ownCloud作为OmniFocus的云同步服务器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>平时一直使用OmniFocus作为自己的时间管理工具，但是由于我使用的是破解版的（正版太贵，买不起啊），同步就变成了一件很麻烦的事。OmniFocus提供了两种同步方式，如下图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/901f5c4cb502f3fc557e3c3cfa79ad2f.png" alt="1"></p>
<p>一种是使用Omni官方的服务器同步，这种方式需要注册Omni官方账号，应该只有正版能用吧，我没有尝试；另一种方式是使用WebDAV进行同步，这里着重介绍第二种方式。</p>
<p>本文主要分为以下几个部分：</p>
<ol>
<li>WebDAV简介</li>
<li>ownCloud简介以及搭建方法</li>
<li>使用ownCloud作为OmniFocus的同步服务器</li>
<li>ownCloud的一些其他应用</li>
</ol>
<h2 id="WebDAV简介"><a href="#WebDAV简介" class="headerlink" title="WebDAV简介"></a>WebDAV简介</h2><p><a href="http://baike.baidu.com/link?url=pXeqnwgtPiYSKdYGX9YjBH_XeAJsH-aRkQqEYPsbkQwf9hlbnF9RSuAHvCMLboSuENx55T8J9Pd27E6ybo7Aba" target="_blank" rel="external">WebDAV</a>是一种基于 HTTP 1.1协议的通讯协议，可以实现文件的同步。通俗来讲，我们可以利用WebDAV来实现类似百度云一样的网盘功能。</p>
<p><a href="http://blog.sina.com.cn/s/blog_4834fe810101fw17.html" target="_blank" rel="external">这里</a>有几个支持WebDAV协议的网盘，但是都是国外的，国内据我了解目前只有<a href="http://www.jianguoyun.com/s/campaign/cpclanding/main?sch=bdcpc_nutstore_off&amp;bdtj=1" target="_blank" rel="external">坚果云</a>一家支持WebDAV。至于国内的各大网盘为什么都不支持WebDAV，可以看<a href="http://www.zhihu.com/question/21511143" target="_blank" rel="external">这里</a>。</p>
<p>最初我也本来打算使用国外的网盘来实现WebDAV，但是担心速度不理想，而且国外网盘的免费空间都很小，所以就放弃了。至于坚果云，我也没有去尝试。</p>
<p>进一步Google，于是就找到了ownCloud。</p>
<h2 id="ownCloud简介以及搭建方法"><a href="#ownCloud简介以及搭建方法" class="headerlink" title="ownCloud简介以及搭建方法"></a>ownCloud简介以及搭建方法</h2><p><a href="https://owncloud.org/" target="_blank" rel="external">ownCloud</a>是一个来自KDE社区开发的免费软件，提供私人的Web服务。当前主要功能包括文件管理（内建文件分享）、音乐、日历、联系人等等，可在PC和服务器上运行。简单来说就是一个基于Php的自建网盘。</p>
<p>下面就跟着我使用ownCloud一步一步搭建自己的私人网盘。</p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>因为要把ownCloud搭建在服务器上，因此你需要有一个VPS，内存至少128M，越大越好，我这里使用的是<a href="https://bandwagonhost.com/clientarea.php?action=products" target="_blank" rel="external">搬运工VPS</a>，如何购买VPS可以看我的<a href="http://liujinlongxa.com/2016/06/11/%E6%89%93%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E7%BF%BB%E5%A2%99VPS:%E6%90%AC%E8%BF%90%E5%B7%A5VPS%E8%B4%AD%E4%B9%B0%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B%E5%85%A8%E8%AE%B0%E5%BD%95/">这篇博客</a>。</p>
<h3 id="1-安装PHP和MySQL环境"><a href="#1-安装PHP和MySQL环境" class="headerlink" title="1. 安装PHP和MySQL环境"></a>1. 安装PHP和MySQL环境</h3><p>由于ownCloud使用php实现的，所以需要在你服务器上安装PHP和MySQL环境，这个网上有很多教程，也可以参考ownCloud给出的<a href="https://doc.owncloud.org/server/9.1/admin_manual/installation/php_54_installation.html" target="_blank" rel="external">官方教程</a>。</p>
<h3 id="2-下载服务器源码"><a href="#2-下载服务器源码" class="headerlink" title="2. 下载服务器源码"></a>2. 下载服务器源码</h3><p>在任一文件夹下输入命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget https://download.owncloud.org/community/owncloud-9.1.0.tar.bz2</div><div class="line">tar xvf owncloud-9.1.0.tar.bz2</div></pre></td></tr></table></figure>
<p>然后改变owncloud这个文件的权限，命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod 777 owncloud</div></pre></td></tr></table></figure>
<h3 id="3-添加管理员账号"><a href="#3-添加管理员账号" class="headerlink" title="3. 添加管理员账号"></a>3. 添加管理员账号</h3><p>使用浏览器访问地址<a href="http://serveraddress/owncloud/" target="_blank" rel="external">http://serveraddress/owncloud/</a> (serveraddress即你服务器的ip地址)就可以看到如下页面：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/5de5eb45600b86bae8e2c0cfdaadb319.png" alt="2"></p>
<p>在这里自定义一个管理员的账号和密码，然后点击FinishSetup，这样一个ownCloud就搭建完成了。</p>
<h2 id="使用ownCloud作为OmniFocus的同步服务器"><a href="#使用ownCloud作为OmniFocus的同步服务器" class="headerlink" title="使用ownCloud作为OmniFocus的同步服务器"></a>使用ownCloud作为OmniFocus的同步服务器</h2><p>ownCloud搭建完成后，就可以把它作为Omni的同步服务器了，具体方法如下：</p>
<p>打开OmniFocus的同步设置页面，选择WebDAV方式同步，然后在Address中填入如下地址：</p>
<blockquote>
<p>http://<serveraddress>/owncloud/remote.php/dav/files/<adminname></adminname></serveraddress></p>
</blockquote>
<p><serveraddress>和<adminname>分别替换为你的服务器地址和刚才填的管理员用户名，如下图：</adminname></serveraddress></p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/264b1ec833e6078643e9c2f40b2bf7aa.png" alt="3"></p>
<p>然后点击“Sync Now”进行同步，会提示输入密码，输入刚才添加的管理员密码，然后就可以同步成功了。</p>
<p>使用浏览器访问<a href="http://serveraddress/owncloud/" target="_blank" rel="external">http://serveraddress/owncloud/</a> ，就可以看到刚刚同步上去的文件了，如下图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/0da7c4ef259b48e8f608540c27091cbd.png" alt="4"></p>
<h2 id="ownCloud的一些其他应用"><a href="#ownCloud的一些其他应用" class="headerlink" title="ownCloud的一些其他应用"></a>ownCloud的一些其他应用</h2><p>ownCloud还提供了多平台的客户端，包括iOS，Android，Mac，Windows等，你可以下载一个Mac客户端，然后设置一个同步文件夹，凡是放在这个文件夹里的文件，都会被自动同步到服务器上。如下图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/d7b6c828536bab1e8fa5a69a12332ebf.png" alt="5"></p>
<p>我把Quiver的笔记数据也同步到了服务器上。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>其实ownCloud的功能还远不止这些，还有很多功能还待以后慢慢探索。</p>
<p>类似ownCloud的还有一个叫<a href="https://www.seafile.com/home/" target="_blank" rel="external">seafile</a>的服务，两者的区别和优劣可以参考<a href="http://www.zhihu.com/question/23929945" target="_blank" rel="external">这里</a>。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://doc.owncloud.org/server/9.1/admin_manual/contents.html" target="_blank" rel="external">ownCloud官方文档</a><br><a href="https://doc.owncloud.org/server/9.1/user_manual/files/access_webdav.html" target="_blank" rel="external">ownCloud关于WebDAV使用的文档</a><br><a href="http://jjliu.blog.ustc.edu.cn/198/" target="_blank" rel="external">使用OwnCloud创建私有云</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/08/24/使用ownCloud作为OmniFocus的云同步服务器/" data-id="civ7gro6e002lh4m0zww8uxnl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WebDAV/">WebDAV</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ownCloud/">ownCloud</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/其他/">其他</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-在VPS上搭建Git服务器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/07/在VPS上搭建Git服务器/" class="article-date">
  <time datetime="2016-08-07T07:27:52.000Z" itemprop="datePublished">2016-08-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Git/">Git</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/07/在VPS上搭建Git服务器/">在VPS上搭建Git服务器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>昨天尝试了在自己的VPS上搭建一个git服务器，中间踩了很多坑，下面是我整个搭建的过程。</p>
<h2 id="具体流程"><a href="#具体流程" class="headerlink" title="具体流程"></a>具体流程</h2><h3 id="第一步：安装Git"><a href="#第一步：安装Git" class="headerlink" title="第一步：安装Git"></a>第一步：安装Git</h3><p>打开VPS(这里我用的是<a href="https://bandwagonhost.com/index.php" target="_blank" rel="external">搬运工</a>，怎么购买VPS可以参考我的<a href="http://liujinlongxa.com/2016/06/11/%E6%89%93%E9%80%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E7%BF%BB%E5%A2%99VPS:%E6%90%AC%E8%BF%90%E5%B7%A5VPS%E8%B4%AD%E4%B9%B0%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B%E5%85%A8%E8%AE%B0%E5%BD%95/">这篇博客</a>)的控制后台，进入Shell，然后输入命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install -y git</div></pre></td></tr></table></figure>
<p>执行完后如图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/b9dd798ab599b9b53adebee98ebe5bbd.png" alt="2"></p>
<p>查看Git版本，如果能显示Git版本，则说明安装成功。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/d7cdff1b7006e2c9b5f1e521319d903c.png" alt="3"></p>
<h3 id="第二步：添加用户"><a href="#第二步：添加用户" class="headerlink" title="第二步：添加用户"></a>第二步：添加用户</h3><p>输入命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">adduser git</div><div class="line">su git</div></pre></td></tr></table></figure>
<p>添加一个名为git的用户，并且将当前用户切换到git</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/c5350088190cd59d220b4942b9d87eae.png" alt="4"></p>
<h3 id="第三步：创建仓库"><a href="#第三步：创建仓库" class="headerlink" title="第三步：创建仓库"></a>第三步：创建仓库</h3><p>创建一个文件夹用来存放git仓库，然后输入命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git init --bare mycode.git</div></pre></td></tr></table></figure>
<p>这样就可以创建一个裸仓库，因为服务器上的Git仓库纯粹是为了共享，所以不让用户直接登录到服务器上去改工作区，如下图：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/c58f27e2d859d984c844371a43a37ab8.png" alt="5"></p>
<p>把服务器的git仓库的用户组改为git</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/26a614c08121e4b0f8783551208e2d19.png" alt="6"></p>
<p>这样仓库就创建完了</p>
<h3 id="第四步：创建证书"><a href="#第四步：创建证书" class="headerlink" title="第四步：创建证书"></a>第四步：创建证书</h3><p>在服务器/homg/git目录下创建文件夹.ssh，然后在.ssh文件夹里创建authorized_keys</p>
<p><strong> 注意：一定要切换到git用户下再创建，否则使用root用户创建，会因为文件夹权限的问题而造成RSA校验失败，我就是在这里卡了半天 </strong></p>
<p>然后在客户端创建公钥，即~/.ssh/id_rsa.pub文件里的内容，然后把公钥填入服务器的authorized_keys文件中</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/9eca6530c312dc064c8901735ef9942e.png" alt="7"></p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/7c38fa2c806440f162b83208038a8dc9.png" alt="8"></p>
<h3 id="第五步：打开服务器RSA验证"><a href="#第五步：打开服务器RSA验证" class="headerlink" title="第五步：打开服务器RSA验证"></a>第五步：打开服务器RSA验证</h3><p>进入服务器/etc/ssh目录，使用vim打开sshd_config（建议先做一个备份），修改如下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">RSAAuthentication yes     </div><div class="line">PubkeyAuthentication yes     </div><div class="line">AuthorizedKeysFile  .ssh/authorized_keys</div></pre></td></tr></table></figure>
<p>大部分Linux系统的RSA认证默认就是开启的，如果已经开启，则可以忽略(在这里也卡了好久😭)</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/9d534724207d6319fcf654142e91ba24.png" alt="9"></p>
<p>然后保存退出，重新启动sshd</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/74d02be9217b7ea806af5970560ac956.png" alt="10"></p>
<h3 id="第六步：修改指定服务器的ssh端口"><a href="#第六步：修改指定服务器的ssh端口" class="headerlink" title="第六步：修改指定服务器的ssh端口"></a>第六步：修改指定服务器的ssh端口</h3><p>一般ssh访问默认的端口是22，但是搬运工VPS修改了ssh访问的端口，而Git访问还是用还是22端口，因此要修改Git使用ssh访问的端口(在这里也卡了好久😭)，要查看ssh端口可以在服务器的sshd_config文件中查看，如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/b2f7743ffae9917e88f0ace60e11637b.png" alt="11"></p>
<p> 如果不想修改服务器端口配置，可以修改客户端访问端口。在客户端的/~/.ssh/config文件中添加如下两行，第一行是服务器的地址，第二行是服务器的端口</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/17e45daf40d28f1174387104a3daef40.png" alt="12"></p>
<p>这样就修改了访问指定服务器时的ssh端口。</p>
<h3 id="第七步：创建本地仓库"><a href="#第七步：创建本地仓库" class="headerlink" title="第七步：创建本地仓库"></a>第七步：创建本地仓库</h3><p>经过以上六步，一个Git服务器就建立好了，现在你就可以把仓库clone下来，然后开始使用了。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/285c535aa2610ae916b1f964617a8d68.png" alt="13"></p>
<h2 id="遇到的坑"><a href="#遇到的坑" class="headerlink" title="遇到的坑"></a>遇到的坑</h2><p>在整个搭建过程中，我也踩了很多坑，下面对这些坑做一个总结。</p>
<h3 id="服务器与客户端ssh端口不一致"><a href="#服务器与客户端ssh端口不一致" class="headerlink" title="服务器与客户端ssh端口不一致"></a>服务器与客户端ssh端口不一致</h3><p>在完成创建证书之后，按理说，应该已经可以clone仓库了，但是我尝试克隆会报如下错误：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/e5bc21bbdb55bcdf473e6addf69cf495.png" alt="14"></p>
<p>网上找了很多方法，最后发现是因为客户端和服务器的ssh端口不一致导致，修改了客户端的ssh访问端口才解决了这个问题。</p>
<p>相关参考：<a href="http://zengrong.net/post/1544.htm" target="_blank" rel="external">修改了SSH默认端口之后，如何配置git？</a></p>
<h3 id="ssh验证失败"><a href="#ssh验证失败" class="headerlink" title="ssh验证失败"></a>ssh验证失败</h3><p>修改了ssh端口后，可以访问仓库了，但是每次访问都要输入密码，按理说我已经创建了证书，并且也把公钥放到了服务器，为什么还是不行呢？</p>
<p>找了半天，发现服务器的RSA身份校验压根就没有开启，ssh在校验时是先使用RSA进行校验，如果校验失败再使用密码进行校验。修改sshd_config文件，打开身份校验，参照上面的第五步。</p>
<p>打开身份校验之后，发现还是要输入密码。最初我的做法是关闭服务器的ssh密码校验，修改服务器/etc/ssh/sshd_config文件如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PasswordAuthentication no</div></pre></td></tr></table></figure>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/fadd0406c6a9e9c02402e170082c82c7.png" alt="15"></p>
<p>然后重启sshd。</p>
<p>这样修改了之后，由于禁止了密码验证的方式，而RSA验证又失败，所以压根验证失败，访问都访问不了了。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/2b0a4555687ea4fe8326f690ee35533e.png" alt="16"></p>
<p>然后我尝试看Log，输入命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh git@xxx.xxx.xxx.xxx -vvv</div></pre></td></tr></table></figure>
<p>从Log上看，客户端已经把key传给了服务器，但是服务器在验证时失败了，所以八成可能是服务器的问题。</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/8ec00cb79352b30a2f95a1b48410cdfe.png" alt="20"></p>
<p>然后我又根据<a href="http://www.androiddev.net/ssh-public-key-authentication-error/" target="_blank" rel="external">这篇博客</a>修改了目录的权限，但是还是不行。</p>
<p>根据<a href="http://flysnowxf.iteye.com/blog/1567570" target="_blank" rel="external">这篇博客</a>关闭了SELinux也还是不行。</p>
<p>然后我又根据<a href="http://blog.csdn.net/lansesl2008/article/details/16113193" target="_blank" rel="external">这篇博客</a>打开了ssh的log，修改sshd_config如下内容：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/3dc7b3340f6b693b047ecbee93400564.png" alt="17"></p>
<p>然后又重新登录和退出几次ssh，在/var/log/secure里看到了如下内容：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/4f320784c4d9d731d53b3792856ec4dd.png" alt="18"></p>
<p>并没有什么有用的信息，不知道是不是我的Log配置的有问题。</p>
<p>找了很多资料，有很多文章都提到了文件夹权限的问题，于是我又回到服务器git目录下看了一下文件夹的权限：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/c9be98241282c46c0111cb25e1be9aa4.png" alt="19"></p>
<p>原来我在创建.ssh目录是用的是root账户，所有造成ssh在进行身份认证时没有权限方位.ssh目录，导致认证失败。输入命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chown git .ssh</div></pre></td></tr></table></figure>
<p>将.ssh文件夹的所属用户改为git，.ssh里的authorized_keys文件也做相同的处理，这样改了之后终于可以验证成功了，并且不用输入密码了。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>整个搭建过程用了将近一天的时间，虽然过程有些曲折，但是最终还是成功了，而且这个过程中我也学到了不少的东西，更加深入的了解了ssh服务。</p>
<p>希望这篇文章能对大家在搭建git服务器时有所帮助。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://blog.csdn.net/wave_1102/article/details/47779401" target="_blank" rel="external">在CentOS下搭建自己的Git服务器</a><br><a href="http://blog.csdn.net/jacky0922/article/details/17999271" target="_blank" rel="external">ssh无密码登录认证失败</a><br><a href="http://blog.csdn.net/lansesl2008/article/details/16113193" target="_blank" rel="external">sshd_config配置详解</a><br><a href="http://www.androiddev.net/ssh-public-key-authentication-error/" target="_blank" rel="external">一个SSH 公钥登录失败的问题及解决经验</a><br><a href="http://www.linuxquestions.org/questions/linux-newbie-8/permission-denied-publickey-gssapi-keyex-gssapi-with-mic-password-4175413607/" target="_blank" rel="external">Permission denied (publickey, gssapi-keyex,gssapi-with-mic,password)</a><br><a href="http://flysnowxf.iteye.com/blog/1567570" target="_blank" rel="external">ssh使用公钥授权不通过的问题解决</a><br><a href="http://zengrong.net/post/1544.htm" target="_blank" rel="external">修改了SSH默认端口之后，如何配置git？</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/08/07/在VPS上搭建Git服务器/" data-id="civ7gro6c002hh4m0375gs4mm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用HTTPS方法clone下来的Git仓库push时报错" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/30/使用HTTPS方法clone下来的Git仓库push时报错/" class="article-date">
  <time datetime="2016-07-30T03:22:55.000Z" itemprop="datePublished">2016-07-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Git/">Git</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/30/使用HTTPS方法clone下来的Git仓库push时报错/">使用HTTPS方法clone下来的Git仓库push时报错</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>昨天在使用Git时遇到了一个问题，今天记录一下。</p>
<p>一般我在克隆Github的项目时都是使用ssh的方式进行的，这样只要你的ssh-key配置正确，就没有问题。昨天心血来潮试了一下https克隆了一个项目，修改完后，准备push的时候需要了问题，问题如下：</p>
<blockquote>
<p>remote: Permission to liujinlongxa/Spoon-Knife.git denied to xxxx.<br>fatal: unable to access ‘<a href="https://github.com/liujinlongxa/Spoon-Knife.git/" target="_blank" rel="external">https://github.com/liujinlongxa/Spoon-Knife.git/</a>‘: The requested URL returned error: 403</p>
</blockquote>
<p>解决方案是修改git的配置文件，</p>
<p><code>vim .git/config</code></p>
<p>将</p>
<blockquote>
<p>[remote “origin”]<br>        url = <a href="https://github.com/liujinlongxa/Spoon-Knife.git" target="_blank" rel="external">https://github.com/liujinlongxa/Spoon-Knife.git</a></p>
</blockquote>
<p>改为</p>
<blockquote>
<p>[remote “origin”]<br>        url = <a href="https://liujinlongxa@github.com/liujinlongxa/Spoon-Knife.git" target="_blank" rel="external">https://liujinlongxa@github.com/liujinlongxa/Spoon-Knife.git</a></p>
</blockquote>
<p>即前面加上用户名，这样就可以正常的push，或者直接运行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config --local remote.origin.url https://liujinlongxa@github.com/liujinlongxa/Spoon-Knife.git</div></pre></td></tr></table></figure>
<p>也可以达到相同的效果。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/07/30/使用HTTPS方法clone下来的Git仓库push时报错/" data-id="civ7gro6a002fh4m0pfnuqet5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-UIButton设置标题无效" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/26/UIButton设置标题无效/" class="article-date">
  <time datetime="2016-07-26T15:19:02.000Z" itemprop="datePublished">2016-07-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/26/UIButton设置标题无效/">UIButton设置标题无效</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>UIButton在使用<code>setAttributedTitle:forState:</code>设置了富文本标题后，是使用<code>setTitle:forState:</code>设置标题是没有效果的，解决方案是先把富文本去掉，然后再使用<code>setTitle:forState:</code>设置标题，或者直接使用<code>setAttributedTitle:forState:</code>重新设置不带属性的富文本。代码如下：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="keyword">self</span>.payButton setAttributedTitle:<span class="literal">nil</span> forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">[<span class="keyword">self</span>.payButton setTitle:<span class="string">@"余额不足，去充值"</span> forState:<span class="built_in">UIControlStateNormal</span>];</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/07/26/UIButton设置标题无效/" data-id="civ7gro5z002bh4m0de8ov6g8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UIButton/">UIButton</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-深入理解CoreAnimation的fillMode和isRemovedOnCompletion" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/10/深入理解CoreAnimation的fillMode和isRemovedOnCompletion/" class="article-date">
  <time datetime="2016-07-10T06:34:06.000Z" itemprop="datePublished">2016-07-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS开发/">iOS开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/10/深入理解CoreAnimation的fillMode和isRemovedOnCompletion/">深入理解CoreAnimation的fillMode和isRemovedOnCompletion</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>一般在使用CoreAnimation写动画是，在定义CAAnimation时，都要加入如下两句来防止动画完成后视图的位置又还原成了原来的位置。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">animation.fillMode = kCAFillModeBoth</div><div class="line">animation.isRemovedOnCompletion = <span class="literal">false</span></div></pre></td></tr></table></figure>
<p>很少有文章能详细说明这两个属性的作用，今天我们就来深究一下这两个属性。</p>
<h2 id="fillMode"><a href="#fillMode" class="headerlink" title="fillMode"></a>fillMode</h2><p>fillMode是一个枚举值，用于表示动画在开始和结束时的状态，这样说可能不太好理解，直接看例子比较直观。</p>
<h3 id="kCAFillModeRemoved"><a href="#kCAFillModeRemoved" class="headerlink" title="kCAFillModeRemoved"></a>kCAFillModeRemoved</h3><p>这个是fillMode的默认值，表示在到达beginTime时才显示动画的第一帧，动画结束时，删除CALayer做的变化</p>
<p>实例代码：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesBegan</span><span class="params">(touches: Set&lt;UITouch&gt;, withEvent event: UIEvent?)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> move = <span class="type">CABasicAnimation</span>(keyPath: <span class="string">"position.y"</span>)</div><div class="line">    move.fromValue = <span class="number">100</span></div><div class="line">    move.toValue = <span class="number">500</span></div><div class="line">    move.duration = <span class="number">1.0</span></div><div class="line">    move.beginTime = <span class="type">CACurrentMediaTime</span>() + <span class="number">2.0</span></div><div class="line">    move.fillMode = kCAFillModeRemoved</div><div class="line">    <span class="keyword">self</span>.myView.layer.add(move, forKey: <span class="literal">nil</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码中，我们将一个View的y坐标从100移动到500，历时1s，注意开始时间我设定为了<code>CACurrentMediaTime() + 2.0</code>，即添加动画2s后才开始执行动画，这样才能看到效果。运行结果如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/kCAFillModeRemoved.gif" alt="kCAFillModeRemoved"></p>
<p>可以看到，在鼠标点击触发后，2s之后myView才移动到了动画的初始位置100开始执行动画，并且在动画结束后视图又立刻恢复到原来的位置。</p>
<h3 id="kCAFillModeBackwards"><a href="#kCAFillModeBackwards" class="headerlink" title="kCAFillModeBackwards"></a>kCAFillModeBackwards</h3><p>这个值表示无论是否到达beginTime，动画开始后，立刻显示动画的第一帧，修改代码如下：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesBegan</span><span class="params">(touches: Set&lt;UITouch&gt;, withEvent event: UIEvent?)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> move = <span class="type">CABasicAnimation</span>(keyPath: <span class="string">"position.y"</span>)</div><div class="line">    move.fromValue = <span class="number">100</span></div><div class="line">    move.toValue = <span class="number">500</span></div><div class="line">    move.duration = <span class="number">1.0</span></div><div class="line">    move.beginTime = <span class="type">CACurrentMediaTime</span>() + <span class="number">2.0</span></div><div class="line">    move.fillMode = kCAFillModeBackwards</div><div class="line">    <span class="keyword">self</span>.myView.layer.add(move, forKey: <span class="literal">nil</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行效果如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/kCAFillModeBackwards.gif" alt="kCAFillModeBackwards"></p>
<p>可以看到，鼠标点击后，myView立刻移动到了动画的初始位置100，然后2s后开始执行动画。</p>
<h3 id="kCAFillModeForwards"><a href="#kCAFillModeForwards" class="headerlink" title="kCAFillModeForwards"></a>kCAFillModeForwards</h3><p>这个值表示在到达beginTime时显示动画的第一帧，在动画结束时，保持动画最后一帧的状态，直到动画被删除，修改代码如下：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesBegan</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> move = <span class="type">CABasicAnimation</span>(keyPath: <span class="string">"position.y"</span>)</div><div class="line">    move.fromValue = <span class="number">100</span></div><div class="line">    move.toValue = <span class="number">500</span></div><div class="line">    move.duration = <span class="number">1.0</span></div><div class="line">    move.beginTime = <span class="type">CACurrentMediaTime</span>() + <span class="number">2.0</span></div><div class="line">    move.fillMode = kCAFillModeForwards;</div><div class="line">    move.isRemovedOnCompletion = <span class="literal">false</span></div><div class="line">    move.delegate = <span class="keyword">self</span>;</div><div class="line">    <span class="keyword">self</span>.myView.layer.add(move, forKey: <span class="literal">nil</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">animationDidStop</span><span class="params">(<span class="number">_</span> anim: CAAnimation, finished flag: Bool)</span></span> &#123;</div><div class="line">    <span class="type">DispatchQueue</span>.main.after(when: .now() + <span class="number">3</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.myView.layer.removeAllAnimations()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码中添加了<code>move.isRemovedOnCompletion = false</code>，即动画执行完后不立刻删除动画，默认情况下，动画执行完后会立刻删除动画。<code>isRemovedOnCompletion</code>属性设置为false后，就不会立刻删除。然后我们还添加了<code>animationDidStop</code>方法，这个是<code>CABasicAnimation</code>的代理方法，在动画执行结束时会被调用。我们在这个方法里延时3s删除动画。运行效果如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/kCAFillModeForwards.gif" alt="kCAFillModeForwards"></p>
<p>可以看到，鼠标点击后，myView等了2s才移动到动画初始位置，动画结束后，等待了3s，myView才恢复到原来的位置。也就是动画结束后会保持最后一帧的状态，直到动画被删除掉。</p>
<h3 id="kCAFillModeBoth"><a href="#kCAFillModeBoth" class="headerlink" title="kCAFillModeBoth"></a>kCAFillModeBoth</h3><p>这个值相当于kCAFillModeBackwards与kCAFillModeForwards的共同合集，即无论是否到达beginTime，动画开始后，立刻显示动画的第一帧，并且在动画结束时保持最后一帧的状态，直到动画被删除。修改代码如下：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesBegan</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> move = <span class="type">CABasicAnimation</span>(keyPath: <span class="string">"position.y"</span>)</div><div class="line">    move.fromValue = <span class="number">100</span></div><div class="line">    move.toValue = <span class="number">500</span></div><div class="line">    move.duration = <span class="number">1.0</span></div><div class="line">    move.beginTime = <span class="type">CACurrentMediaTime</span>() + <span class="number">2.0</span></div><div class="line">    move.fillMode = kCAFillModeBoth;</div><div class="line">    move.isRemovedOnCompletion = <span class="literal">false</span></div><div class="line">    move.delegate = <span class="keyword">self</span>;</div><div class="line">    <span class="keyword">self</span>.myView.layer.add(move, forKey: <span class="literal">nil</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">animationDidStop</span><span class="params">(<span class="number">_</span> anim: CAAnimation, finished flag: Bool)</span></span> &#123;</div><div class="line">    <span class="type">DispatchQueue</span>.main.after(when: .now() + <span class="number">3</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.myView.layer.removeAllAnimations()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行效果如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/kCAFillModeBoth.gif" alt="kCAFillModeBoth"></p>
<p>可以看到，鼠标点击后，myView立刻移动到了动画的初始位置，然后动画结束后，等待了3s，myView才恢复到原来的位置。</p>
<h2 id="更进一步的思考"><a href="#更进一步的思考" class="headerlink" title="更进一步的思考"></a>更进一步的思考</h2><p>以上就是我对fillMode的一个探究，下面再回到文章开头的那段代码</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">animation.fillMode = kCAFillModeBoth</div><div class="line">animation.isRemovedOnCompletion = <span class="literal">false</span></div></pre></td></tr></table></figure>
<p>这时，就很明白了，设置fillMode为<code>kCAFillModeBoth</code>，可以使视图在动画结束时，仍然停留在动画结束的位置，直到动画被删除。设置<code>isRemovedOnCompletion</code>为false，可以使动画在结束后不被删除，这样视图就会永远停留在动画结束的位置。</p>
<p>乍一看没什么问题，但仔细想想还是觉得有点奇怪，动画已经结束了为什么不删除，还占着内存。如果动画少还好，如果动画非常多，每个动画执行完了都不删除的话，那内存岂不是会爆掉，这是不能接受的。有没有办法能够既让视图停留在动画结束的位置，又能在动画结束后删除动画呢？</p>
<p>当然有，直接上代码：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesBegan</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> move = <span class="type">CABasicAnimation</span>(keyPath: <span class="string">"position.y"</span>)</div><div class="line">    move.fromValue = <span class="number">100</span></div><div class="line">    move.toValue = <span class="number">500</span></div><div class="line">    move.duration = <span class="number">1.0</span></div><div class="line">    move.beginTime = <span class="type">CACurrentMediaTime</span>() + <span class="number">2.0</span></div><div class="line">    move.fillMode = kCAFillModeBoth;</div><div class="line">    move.delegate = <span class="keyword">self</span>;</div><div class="line">    <span class="keyword">self</span>.myView.layer.add(move, forKey: <span class="literal">nil</span>)</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.myView.layer.position.y = <span class="number">500</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>解决方法就是在视图添加动画后，手动修改视图的位置为动画结束后的最终位置，这样动画结束后，动画就会被删除并且视图会停留在动画结束时的位置。</p>
<p>注意：这里应该使用layer的position，不能直接修改UIView的frame，否则动画效果会不正确。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.raywenderlich.com/store/ios-animations-by-tutorials" target="_blank" rel="external">iOS Animations by Tutorials</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/07/10/深入理解CoreAnimation的fillMode和isRemovedOnCompletion/" data-id="civ7gro5w0028h4m06hcf8zjt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CoreAnimation/">CoreAnimation</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-用XCode8打开Xib后项目不能在XCode7上运行" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/03/用XCode8打开Xib后项目不能在XCode7上运行/" class="article-date">
  <time datetime="2016-07-03T10:56:06.000Z" itemprop="datePublished">2016-07-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/03/用XCode8打开Xib后项目不能在XCode7上运行/">用XCode8打开Xib后项目不能在XCode7上运行</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>可以设置xib以Xcode7.x的方法打开，参考如下</p>
<p><a href="http://stackoverflow.com/questions/37851459/the-document-main-storyboard-requires-xcode-8-0-or-later" target="_blank" rel="external">The document Main.storyboard requires Xcode 8.0 or later</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/07/03/用XCode8打开Xib后项目不能在XCode7上运行/" data-id="civ7gro5s0022h4m0z3kdl0f2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/其他/">其他</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Could-not-load-the-xxx-image-referenced-from-a-nib-in-the-bundle-with-identifier-xxxx问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/03/Could-not-load-the-xxx-image-referenced-from-a-nib-in-the-bundle-with-identifier-xxxx问题/" class="article-date">
  <time datetime="2016-07-03T10:51:49.000Z" itemprop="datePublished">2016-07-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/03/Could-not-load-the-xxx-image-referenced-from-a-nib-in-the-bundle-with-identifier-xxxx问题/">Could not load the xxx image referenced from a nib in the bundle with identifier xxxx问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>出现在非retina的屏幕上，不能正确加载xib上的图片，只能通过代码重新设置图片。还没有找到其他解决办法。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/07/03/Could-not-load-the-xxx-image-referenced-from-a-nib-in-the-bundle-with-identifier-xxxx问题/" data-id="civ7gro5l001vh4m0uvpg07qn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/其他/">其他</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-设置富文本字间距，文字不能居中对齐" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/03/设置富文本字间距，文字不能居中对齐/" class="article-date">
  <time datetime="2016-07-03T10:40:19.000Z" itemprop="datePublished">2016-07-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/iOS-Tips/">iOS Tips</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/03/设置富文本字间距，文字不能居中对齐/">设置富文本字间距，文字不能居中对齐</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近有一个需求，需要设置一个UILabel的字间距，我马上就想到了富文本，于是就写了下面的代码</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *str = <span class="keyword">self</span>.label.text;</div><div class="line"><span class="built_in">NSDictionary</span> *attribute = @&#123;<span class="built_in">NSKernAttributeName</span>:@(<span class="number">10</span>),</div><div class="line">                            <span class="built_in">NSFontAttributeName</span>:[<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">15</span>]&#125;;</div><div class="line"><span class="built_in">NSAttributedString</span> *attStr = [[<span class="built_in">NSAttributedString</span> alloc] initWithString:str attributes:attribute];</div><div class="line"><span class="keyword">self</span>.label.attributedText = attStr;</div></pre></td></tr></table></figure>
<p>其中NSKernAttributeName属性就是设置文字的字间距。但是，现在就有一个问题，设置字间距后，原本居中显示的文字，不能居中显示了。</p>
<p>这是我设置字间距之前的label</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/3cba47225e6b1a02cfad6885a67d83ed.png" alt="1"></p>
<p>这是我设置了字间距后的label</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/424954a63f3e38514b84ab7277269336.png" alt="2"></p>
<p>“你”字距左边距明显要比”鸿”字的右边距要大。</p>
<p>经过一阵Google，在StackOverflow上找到了相同的问题，链接是<a href="http://stackoverflow.com/questions/23741850/nsstring-drawinrectwithattributes-not-correctly-centered-when-using-nskernattr" target="_blank" rel="external">http://stackoverflow.com/questions/23741850/nsstring-drawinrectwithattributes-not-correctly-centered-when-using-nskernattr</a>，根据问题回答里的做法，我把代码做了修改，如下：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *str = <span class="keyword">self</span>.label.text;</div><div class="line"><span class="built_in">NSMutableAttributedString</span> *mutAttStr = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:str];</div><div class="line">[mutAttStr addAttribute:<span class="built_in">NSKernAttributeName</span> value:@(<span class="number">10</span>) range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, str.length - <span class="number">1</span>)];</div><div class="line">[mutAttStr addAttribute:<span class="built_in">NSFontAttributeName</span> value:[<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">15</span>] range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, str.length)];</div><div class="line"><span class="keyword">self</span>.label.attributedText = [mutAttStr <span class="keyword">copy</span>];</div></pre></td></tr></table></figure>
<p>修改后效果如下：</p>
<p><img src="http://7xn88v.com1.z0.glb.clouddn.com/35b1f58bf08aa3dc7b827edb1da01e80.png" alt="3"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://liujinlongxa.com/2016/07/03/设置富文本字间距，文字不能居中对齐/" data-id="civ7gro5u0025h4m0vbaz0zz4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NSAttributedString/">NSAttributedString</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UILabel/">UILabel</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Swift/">Swift</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS-Tips/">iOS Tips</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS开发/">iOS开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/其他/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/树莓派/">树莓派</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Autolayout/">Autolayout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CocoaPods/">CocoaPods</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CoreAnimation/">CoreAnimation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Emoji表情/">Emoji表情</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDFA/">IDFA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSAttributedString/">NSAttributedString</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scheme/">Scheme</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/">Swift</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Target/">Target</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UIButton/">UIButton</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UILabel/">UILabel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebDAV/">WebDAV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS开发/">iOS开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ownCloud/">ownCloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/其他/">其他</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/加密解密/">加密解密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/本地化/">本地化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树莓派/">树莓派</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/预处理宏/">预处理宏</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Autolayout/" style="font-size: 10px;">Autolayout</a> <a href="/tags/CocoaPods/" style="font-size: 10px;">CocoaPods</a> <a href="/tags/CoreAnimation/" style="font-size: 10px;">CoreAnimation</a> <a href="/tags/Emoji表情/" style="font-size: 10px;">Emoji表情</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/IDFA/" style="font-size: 10px;">IDFA</a> <a href="/tags/NSAttributedString/" style="font-size: 10px;">NSAttributedString</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/Scheme/" style="font-size: 10px;">Scheme</a> <a href="/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/tags/Target/" style="font-size: 15px;">Target</a> <a href="/tags/UIButton/" style="font-size: 10px;">UIButton</a> <a href="/tags/UILabel/" style="font-size: 15px;">UILabel</a> <a href="/tags/WebDAV/" style="font-size: 10px;">WebDAV</a> <a href="/tags/iOS开发/" style="font-size: 10px;">iOS开发</a> <a href="/tags/ownCloud/" style="font-size: 10px;">ownCloud</a> <a href="/tags/其他/" style="font-size: 20px;">其他</a> <a href="/tags/加密解密/" style="font-size: 10px;">加密解密</a> <a href="/tags/本地化/" style="font-size: 10px;">本地化</a> <a href="/tags/树莓派/" style="font-size: 10px;">树莓派</a> <a href="/tags/网络/" style="font-size: 10px;">网络</a> <a href="/tags/预处理宏/" style="font-size: 10px;">预处理宏</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/11/05/使用nat123实现外网ssh连接内网树莓派设备/">使用nat123实现外网ssh连接内网树莓派设备</a>
          </li>
        
          <li>
            <a href="/2016/10/28/Swift3中的预处理宏/">Swift3中的预处理宏</a>
          </li>
        
          <li>
            <a href="/2016/10/26/给多个Target添加CocoaPods/">给多个Target添加CocoaPods</a>
          </li>
        
          <li>
            <a href="/2016/10/25/如何获取WebView的UserAgent/">如何获取WebView的UserAgent</a>
          </li>
        
          <li>
            <a href="/2016/10/18/iOS10无法获取IDFA的问题/">iOS10无法获取IDFA的问题</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 liujinlongxa<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>