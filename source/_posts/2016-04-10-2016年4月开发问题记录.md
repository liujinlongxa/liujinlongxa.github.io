---
layout: post
title: "2016年4月开发问题记录"
categories: "iOS开发"
---

决定每个月用一篇博客将自己这一个月在工作或者学习中遇到的问题记录下来，大部分都是一些零碎的知识点。这是2016年4月份的问题记录，现在是4月10日，如果后续还有问题，会更新到这篇博客中。

## UILabel设置lineBreakMode属性无效

Tag: UILabel, lineBreakMode

UILabel的lineBreakMode属性用于设置文字的截断方式，我在使用过程中，发现了一个问题，当我设置lineBreakMode为NSLineBreakByCharWrapping或NSLineBreakByWordWrapping时，有时会没有效果，它依然以NSLineBreakByClipping方式显示。

经过一番Google，原来，要设置NSLineBreakByCharWrapping或NSLineBreakByWordWrapping，UILabel的numberOfLines必须是0，否则就会无效。

## 设置富文本字间距，文字不能居中对齐

最近有一个需求，需要设置一个UILabel的字间距，我马上就想到了富文本，于是就写了下面的代码

```objectivec
NSString *str = self.label.text;
NSDictionary *attribute = @{NSKernAttributeName:@(10),
                            NSFontAttributeName:[UIFont systemFontOfSize:15]};
NSAttributedString *attStr = [[NSAttributedString alloc] initWithString:str attributes:attribute];
self.label.attributedText = attStr;
```

其中NSKernAttributeName属性就是设置文字的字间距。但是，现在就有一个问题，设置字间距后，原本居中显示的文字，不能居中显示了。

这是我设置字间距之前的label

![1](http://7xn88v.com1.z0.glb.clouddn.com/3cba47225e6b1a02cfad6885a67d83ed.png)

这是我设置了字间距后的label

![2](http://7xn88v.com1.z0.glb.clouddn.com/424954a63f3e38514b84ab7277269336.png)

"你"字距左边距明显要比"鸿"字的右边距要大。

经过一阵Google，在StackOverflow上找到了相同的问题，链接是[http://stackoverflow.com/questions/23741850/nsstring-drawinrectwithattributes-not-correctly-centered-when-using-nskernattr](http://stackoverflow.com/questions/23741850/nsstring-drawinrectwithattributes-not-correctly-centered-when-using-nskernattr)，根据问题回答里的做法，我把代码做了修改，如下：

```objectivec
NSString *str = self.label.text;
NSMutableAttributedString *mutAttStr = [[NSMutableAttributedString alloc] initWithString:str];
[mutAttStr addAttribute:NSKernAttributeName value:@(10) range:NSMakeRange(0, str.length - 1)];
[mutAttStr addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:15] range:NSMakeRange(0, str.length)];
self.label.attributedText = [mutAttStr copy];
```

修改后效果如下：

![3](http://7xn88v.com1.z0.glb.clouddn.com/35b1f58bf08aa3dc7b827edb1da01e80.png)
